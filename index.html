<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CCTV Placement Simulator</title>
  <style>
    body {
      margin: 0;
      background: black;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    #gameCanvas {
      border: 2px solid white;
      background: black;
    }
    #scoreBtn {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <button id="scoreBtn">Check Score</button>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // Load images
    const floorplan = new Image();
    floorplan.src = "floorplan.png";

    const cameraImg = new Image();
    cameraImg.src = "camera.png";

    // Cameras (draggable objects)
    const cameras = [
      {x: 100, y: 100, dragging: false},
      {x: 200, y: 100, dragging: false},
      {x: 300, y: 100, dragging: false},
      {x: 400, y: 100, dragging: false}
    ];

    const targets = [
      {x: 50, y: 50},
      {x: 750, y: 50},
      {x: 50, y: 550},
      {x: 750, y: 550}
    ];

    let draggingCam = null;

    // Draw everything
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(floorplan, 0, 0, canvas.width, canvas.height);

      // Draw cameras
      cameras.forEach(cam => {
        ctx.drawImage(cameraImg, cam.x - 20, cam.y - 20, 40, 40);
      });
    }

    // Mouse events
    canvas.addEventListener("mousedown", e => {
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;

      cameras.forEach(cam => {
        if (mouseX > cam.x - 20 && mouseX < cam.x + 20 &&
            mouseY > cam.y - 20 && mouseY < cam.y + 20) {
          cam.dragging = true;
          draggingCam = cam;
        }
      });
    });

    canvas.addEventListener("mousemove", e => {
      if (draggingCam) {
        const rect = canvas.getBoundingClientRect();
        draggingCam.x = e.clientX - rect.left;
        draggingCam.y = e.clientY - rect.top;
      }
    });

    canvas.addEventListener("mouseup", () => {
      if (draggingCam) {
        draggingCam.dragging = false;
        draggingCam = null;
      }
    });

    // Score button
    document.getElementById("scoreBtn").addEventListener("click", () => {
      let score = 0;
      cameras.forEach((cam, i) => {
        const tx = targets[i].x;
        const ty = targets[i].y;
        if (Math.abs(cam.x - tx) < 40 && Math.abs(cam.y - ty) < 40) {
          score++;
        }
      });
      alert(`You placed ${score}/4 cameras correctly!`);
    });

    // Game loop
    function loop() {
      draw();
      requestAnimationFrame(loop);
    }

    floorplan.onload = loop;
  </script>
</body>
</html>
